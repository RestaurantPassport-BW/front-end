import React from "react";
import { withFormik, Form, Field, ErrorMessage } from "formik";
import * as yup from "yup";
import axiosWithAuth from "../../helpers/axiosWithAuth";
import { Card, Button } from "react-bootstrap";
import { Link } from "react-router-dom";

const Login = ({ errors, touched }) => {
  return (
    <>
      <main>
        <Card className="text-center">
          <Card.Header>
            <svg
              width="127"
              height="27"
              viewBox="0 0 127 27"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M36.0282 15.0535V18.889C36.0282 19.4413 35.5804 19.889 35.0282 19.889H33.4727V6.152H37.9472C38.8655 6.152 39.6603 6.25967 40.3317 6.475C41.003 6.69033 41.5572 6.99117 41.9942 7.3775C42.4312 7.76383 42.7542 8.22617 42.9632 8.7645C43.1722 9.30283 43.2767 9.89183 43.2767 10.5315C43.2767 11.1965 43.1658 11.8077 42.9442 12.365C42.7225 12.916 42.39 13.391 41.9467 13.79C41.5033 14.189 40.9492 14.4993 40.2842 14.721C39.6192 14.9427 38.8402 15.0535 37.9472 15.0535H36.0282ZM36.0282 13.0585H37.9472C38.4158 13.0585 38.8243 13.0015 39.1727 12.8875C39.521 12.7672 39.8092 12.5993 40.0372 12.384C40.2652 12.1623 40.4362 11.8963 40.5502 11.586C40.6642 11.2693 40.7212 10.9178 40.7212 10.5315C40.7212 10.1642 40.6642 9.83167 40.5502 9.534C40.4362 9.23633 40.2652 8.983 40.0372 8.774C39.8092 8.565 39.521 8.40667 39.1727 8.299C38.8243 8.185 38.4158 8.128 37.9472 8.128H36.0282V13.0585Z"
                fill="#333333"
              />
              <path
                d="M55.8708 19.889H53.8948C53.6732 19.889 53.4895 19.8352 53.3438 19.7275C53.2045 19.6135 53.1032 19.4742 53.0398 19.3095L52.0138 16.507H46.3233L45.2973 19.3095C45.2467 19.4552 45.1453 19.5882 44.9933 19.7085C44.8477 19.8288 44.6672 19.889 44.4518 19.889H42.4663L47.8623 6.152H50.4748L55.8708 19.889ZM46.9788 14.702H51.3583L49.6863 10.1325C49.6103 9.92983 49.5248 9.69233 49.4298 9.42C49.3412 9.14133 49.2525 8.8405 49.1638 8.5175C49.0752 8.8405 48.9865 9.14133 48.8978 9.42C48.8155 9.69867 48.7332 9.9425 48.6508 10.1515L46.9788 14.702Z"
                fill="#333333"
              />
              <path
                d="M64.6481 8.6505C64.5784 8.78983 64.4961 8.888 64.4011 8.945C64.3124 9.002 64.2048 9.0305 64.0781 9.0305C63.9514 9.0305 63.8089 8.983 63.6506 8.888C63.4923 8.78667 63.3054 8.67583 63.0901 8.5555C62.8748 8.43517 62.6214 8.3275 62.3301 8.2325C62.0451 8.13117 61.7063 8.0805 61.3136 8.0805C60.9589 8.0805 60.6486 8.12483 60.3826 8.2135C60.1229 8.29583 59.9013 8.413 59.7176 8.565C59.5403 8.717 59.4073 8.90067 59.3186 9.116C59.2299 9.325 59.1856 9.55617 59.1856 9.8095C59.1856 10.1325 59.2743 10.4017 59.4516 10.617C59.6353 10.8323 59.8759 11.016 60.1736 11.168C60.4713 11.32 60.8101 11.4562 61.1901 11.5765C61.5701 11.6968 61.9564 11.8267 62.3491 11.966C62.7481 12.099 63.1376 12.2573 63.5176 12.441C63.8976 12.6183 64.2364 12.8463 64.5341 13.125C64.8318 13.3973 65.0693 13.733 65.2466 14.132C65.4303 14.531 65.5221 15.0155 65.5221 15.5855C65.5221 16.2062 65.4144 16.7888 65.1991 17.3335C64.9901 17.8718 64.6798 18.3437 64.2681 18.749C63.8628 19.148 63.3656 19.4647 62.7766 19.699C62.1876 19.927 61.5131 20.041 60.7531 20.041C60.3161 20.041 59.8854 19.9967 59.4611 19.908C59.0368 19.8257 58.6283 19.7053 58.2356 19.547C57.8493 19.3887 57.4851 19.1987 57.1431 18.977C56.8074 18.7553 56.5066 18.5083 56.2406 18.236L56.9816 17.0105C57.0513 16.9218 57.1336 16.849 57.2286 16.792C57.3299 16.7287 57.4408 16.697 57.5611 16.697C57.7194 16.697 57.8904 16.7635 58.0741 16.8965C58.2578 17.0232 58.4731 17.1657 58.7201 17.324C58.9734 17.4823 59.2679 17.628 59.6036 17.761C59.9456 17.8877 60.3541 17.951 60.8291 17.951C61.5574 17.951 62.1211 17.78 62.5201 17.438C62.9191 17.0897 63.1186 16.5925 63.1186 15.9465C63.1186 15.5855 63.0268 15.291 62.8431 15.063C62.6658 14.835 62.4283 14.645 62.1306 14.493C61.8329 14.3347 61.4941 14.2017 61.1141 14.094C60.7341 13.9863 60.3478 13.8692 59.9551 13.7425C59.5624 13.6158 59.1761 13.4638 58.7961 13.2865C58.4161 13.1092 58.0773 12.878 57.7796 12.593C57.4819 12.308 57.2413 11.9533 57.0576 11.529C56.8803 11.0983 56.7916 10.5695 56.7916 9.9425C56.7916 9.44217 56.8898 8.9545 57.0861 8.4795C57.2888 8.0045 57.5801 7.58333 57.9601 7.216C58.3464 6.84867 58.8183 6.55417 59.3756 6.3325C59.9329 6.11083 60.5694 6 61.2851 6C62.0958 6 62.8431 6.12667 63.5271 6.38C64.2111 6.63333 64.7938 6.988 65.2751 7.444L64.6481 8.6505Z"
                fill="#333333"
              />
              <path
                d="M74.8346 8.6505C74.7649 8.78983 74.6826 8.888 74.5876 8.945C74.499 9.002 74.3913 9.0305 74.2646 9.0305C74.138 9.0305 73.9954 8.983 73.8371 8.888C73.6788 8.78667 73.492 8.67583 73.2766 8.5555C73.0613 8.43517 72.8079 8.3275 72.5166 8.2325C72.2316 8.13117 71.8928 8.0805 71.5001 8.0805C71.1455 8.0805 70.8351 8.12483 70.5691 8.2135C70.3095 8.29583 70.0878 8.413 69.9041 8.565C69.7268 8.717 69.5938 8.90067 69.5051 9.116C69.4165 9.325 69.3721 9.55617 69.3721 9.8095C69.3721 10.1325 69.4608 10.4017 69.6381 10.617C69.8218 10.8323 70.0625 11.016 70.3601 11.168C70.6578 11.32 70.9966 11.4562 71.3766 11.5765C71.7566 11.6968 72.143 11.8267 72.5356 11.966C72.9346 12.099 73.3241 12.2573 73.7041 12.441C74.0841 12.6183 74.423 12.8463 74.7206 13.125C75.0183 13.3973 75.2558 13.733 75.4331 14.132C75.6168 14.531 75.7086 15.0155 75.7086 15.5855C75.7086 16.2062 75.6009 16.7888 75.3856 17.3335C75.1766 17.8718 74.8663 18.3437 74.4546 18.749C74.0493 19.148 73.5521 19.4647 72.9631 19.699C72.3741 19.927 71.6996 20.041 70.9396 20.041C70.5026 20.041 70.0719 19.9967 69.6476 19.908C69.2233 19.8257 68.8148 19.7053 68.4221 19.547C68.0358 19.3887 67.6716 19.1987 67.3296 18.977C66.9939 18.7553 66.6931 18.5083 66.4271 18.236L67.1681 17.0105C67.2378 16.9218 67.3201 16.849 67.4151 16.792C67.5165 16.7287 67.6273 16.697 67.7476 16.697C67.9059 16.697 68.077 16.7635 68.2606 16.8965C68.4443 17.0232 68.6596 17.1657 68.9066 17.324C69.16 17.4823 69.4545 17.628 69.7901 17.761C70.1321 17.8877 70.5406 17.951 71.0156 17.951C71.7439 17.951 72.3076 17.78 72.7066 17.438C73.1056 17.0897 73.3051 16.5925 73.3051 15.9465C73.3051 15.5855 73.2133 15.291 73.0296 15.063C72.8523 14.835 72.6148 14.645 72.3171 14.493C72.0194 14.3347 71.6806 14.2017 71.3006 14.094C70.9206 13.9863 70.5343 13.8692 70.1416 13.7425C69.749 13.6158 69.3626 13.4638 68.9826 13.2865C68.6026 13.1092 68.2638 12.878 67.9661 12.593C67.6684 12.308 67.4278 11.9533 67.2441 11.529C67.0668 11.0983 66.9781 10.5695 66.9781 9.9425C66.9781 9.44217 67.0763 8.9545 67.2726 8.4795C67.4753 8.0045 67.7666 7.58333 68.1466 7.216C68.533 6.84867 69.0048 6.55417 69.5621 6.3325C70.1195 6.11083 70.756 6 71.4716 6C72.2823 6 73.0296 6.12667 73.7136 6.38C74.3976 6.63333 74.9803 6.988 75.4616 7.444L74.8346 8.6505Z"
                fill="#333333"
              />
              <path
                d="M80.2996 15.0535V18.889C80.2996 19.4413 79.8519 19.889 79.2996 19.889H77.7441V6.152H82.2186C83.137 6.152 83.9318 6.25967 84.6031 6.475C85.2745 6.69033 85.8286 6.99117 86.2656 7.3775C86.7026 7.76383 87.0256 8.22617 87.2346 8.7645C87.4436 9.30283 87.5481 9.89183 87.5481 10.5315C87.5481 11.1965 87.4373 11.8077 87.2156 12.365C86.994 12.916 86.6615 13.391 86.2181 13.79C85.7748 14.189 85.2206 14.4993 84.5556 14.721C83.8906 14.9427 83.1116 15.0535 82.2186 15.0535H80.2996ZM80.2996 13.0585H82.2186C82.6873 13.0585 83.0958 13.0015 83.4441 12.8875C83.7925 12.7672 84.0806 12.5993 84.3086 12.384C84.5366 12.1623 84.7076 11.8963 84.8216 11.586C84.9356 11.2693 84.9926 10.9178 84.9926 10.5315C84.9926 10.1642 84.9356 9.83167 84.8216 9.534C84.7076 9.23633 84.5366 8.983 84.3086 8.774C84.0806 8.565 83.7925 8.40667 83.4441 8.299C83.0958 8.185 82.6873 8.128 82.2186 8.128H80.2996V13.0585Z"
                fill="#333333"
              />
              <path
                d="M102.71 13.0205C102.71 14.0275 102.542 14.9617 102.207 15.823C101.871 16.678 101.399 17.419 100.791 18.046C100.183 18.673 99.4516 19.1638 98.5966 19.5185C97.7416 19.8668 96.7948 20.041 95.7561 20.041C94.7175 20.041 93.7675 19.8668 92.9061 19.5185C92.0511 19.1638 91.3165 18.673 90.7021 18.046C90.0941 17.419 89.6223 16.678 89.2866 15.823C88.951 14.9617 88.7831 14.0275 88.7831 13.0205C88.7831 12.0135 88.951 11.0825 89.2866 10.2275C89.6223 9.36617 90.0941 8.622 90.7021 7.995C91.3165 7.368 92.0511 6.88033 92.9061 6.532C93.7675 6.17733 94.7175 6 95.7561 6C96.7948 6 97.7416 6.17733 98.5966 6.532C99.4516 6.88667 100.183 7.3775 100.791 8.0045C101.399 8.62517 101.871 9.36617 102.207 10.2275C102.542 11.0825 102.71 12.0135 102.71 13.0205ZM100.088 13.0205C100.088 12.2668 99.9868 11.5923 99.7841 10.997C99.5878 10.3953 99.3028 9.8855 98.9291 9.4675C98.5555 9.0495 98.0995 8.72967 97.5611 8.508C97.0291 8.28633 96.4275 8.1755 95.7561 8.1755C95.0848 8.1755 94.48 8.28633 93.9416 8.508C93.4033 8.72967 92.9441 9.0495 92.5641 9.4675C92.1905 9.8855 91.9023 10.3953 91.6996 10.997C91.497 11.5923 91.3956 12.2668 91.3956 13.0205C91.3956 13.7742 91.497 14.4518 91.6996 15.0535C91.9023 15.6488 92.1905 16.1555 92.5641 16.5735C92.9441 16.9852 93.4033 17.3018 93.9416 17.5235C94.48 17.7452 95.0848 17.856 95.7561 17.856C96.4275 17.856 97.0291 17.7452 97.5611 17.5235C98.0995 17.3018 98.5555 16.9852 98.9291 16.5735C99.3028 16.1555 99.5878 15.6488 99.7841 15.0535C99.9868 14.4518 100.088 13.7742 100.088 13.0205Z"
                fill="#333333"
              />
              <path
                d="M107.371 14.5215V19.889H104.815V6.152H109.005C109.942 6.152 110.743 6.25017 111.408 6.4465C112.08 6.6365 112.628 6.90567 113.052 7.254C113.483 7.60233 113.796 8.02033 113.992 8.508C114.195 8.98933 114.296 9.52133 114.296 10.104C114.296 10.5663 114.227 11.0033 114.087 11.415C113.954 11.8267 113.758 12.2003 113.498 12.536C113.245 12.8717 112.928 13.1662 112.548 13.4195C112.175 13.6728 111.747 13.8755 111.266 14.0275C111.589 14.2112 111.868 14.474 112.102 14.816L115.541 19.889H113.242C113.02 19.889 112.83 19.8447 112.672 19.756C112.52 19.6673 112.39 19.5407 112.282 19.376L109.394 14.9775C109.287 14.8128 109.166 14.6957 109.033 14.626C108.907 14.5563 108.717 14.5215 108.463 14.5215H107.371ZM107.371 12.688H108.967C109.448 12.688 109.866 12.6278 110.221 12.5075C110.582 12.3872 110.876 12.2225 111.104 12.0135C111.339 11.7982 111.513 11.5448 111.627 11.2535C111.741 10.9622 111.798 10.6423 111.798 10.294C111.798 9.59733 111.567 9.06217 111.104 8.6885C110.648 8.31483 109.949 8.128 109.005 8.128H107.371V12.688Z"
                fill="#333333"
              />
              <path
                d="M126.323 6.152V8.2515H122.19V18.889C122.19 19.4413 121.742 19.889 121.19 19.889H119.635V8.2515H115.483V6.152H126.323Z"
                fill="#333333"
              />
              <rect width="28" height="27" rx="3" fill="#6F52ED" />
              <path
                d="M22 8H19V6C19 4.89 18.11 4 17 4H11C9.89 4 9 4.89 9 6V8H6C4.89 8 4 8.89 4 10V21C4 22.11 4.89 23 6 23H22C23.11 23 24 22.11 24 21V10C24 8.89 23.11 8 22 8ZM11 6H17V8H11V6ZM22 21H6V19H22V21ZM22 16H6V10H9V12H11V10H17V12H19V10H22V16Z"
                fill="white"
              />
            </svg>
          </Card.Header>
          <Card.Body>
            <Card.Title className="cardTitle">Login</Card.Title>
            <Form className="loginForm">
              {/* {touched.email && errors.email && (
                <p className="error">{errors.email}</p>
              )} */}
              <ErrorMessage name="email" />
              <Field
                type="email"
                name="email"
                placeholder="Email:"
                className="input"
              />
              {/* {touched.password && errors.password && (
                <p className="error">{errors.password}</p>
              )} */}
              <ErrorMessage name="password" />
              <Field
                type="password"
                name="password"
                placeholder="Password:"
                className="input"
              />
              <Button type="submit" variant="secondary">
                Login
              </Button>
            </Form>
          </Card.Body>
          <Card.Footer className="text-muted">
            Sign up now to use Passport! <Link to="/register">Register</Link>
          </Card.Footer>
        </Card>
      </main>
    </>
  );
};

export default withFormik({
  mapPropsToValues: ({ email, password }) => {
    return {
      email: email || "",
      password: password || ""
    };
  },
  validationSchema: yup.object().shape({
    email: yup
      .string()
      .email("Please enter a valid email!")
      .required("Email is required!"),
    password: yup.string().required("Password is required")
  }),
  handleSubmit: (values, { props }) => {
    axiosWithAuth()
      .post("https://mhagner-rest-pass.herokuapp.com/api/auth/login", values)
      .then(res => {
        localStorage.setItem("token", res.data.token);
        localStorage.setItem("user", res.data.user.firstName);
        props.history.push("/dashboard");
      })
      .catch(err => alert(err.message));
  }
})(Login);
